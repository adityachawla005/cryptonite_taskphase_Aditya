# SSRF

A SSRF(Server Side Request Forgery)attack is a type of a web vulnerability which allows the atttacker to cause the server side application to make requests to desired localseg.the admin page for the localhost.
Normally writing /admin  but if the request is made from a trusted location as in the local machine it allows us to view the administrator page.

## Against a Local Server

Description: This lab has a stock check feature which fetches data from an internal system.
To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos. 

My Approach:
We can view the check stock page and intercept it.Change the stockApi parameter to http://localhost/admin to view admin page.
Now  we can navigate to the delete page and give the username as Carlos in the stockApi Parameter.
http://localhost/admin/delete?username=carlos 

## Against a Back End System
The application server is able to interact with back-end systems that are not directly reachable by users.

Description:  This lab has a stock check feature which fetches data from an internal system.
To solve the lab, use the stock check functionality to scan the internal 192.168.0.X range for an admin interface on port 8080, then use it to delete the user carlos. 

My Approach:
We can view the check stock page and intercept it.Change the stockApi parameter to http://192.168.0.1:8080/admin since the back end system is on the IP address range and on port 8080.
I learnt the usage of Intruder which help us try different X parameters from 1 to 255 to check which IP gives a code of 200(Request Successful).
I found it at http://192.168.0.208:8080.Then deleted Carlos's username.

## Against blacklist based input filter
 This lab has a stock check feature which fetches data from an internal system.
To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.
The developer has deployed two weak anti-SSRF defenses that you will need to bypass.


My Approach:
I tried approaching the admin page at http://127.0.0.1/ but it was blocked so I tried http://127.1/ and it was blocked also.
I had to see the hint to use a double url encoding %2561 to delete the account.

## For Whitelist(Found it Tough will learn more on it)
In this attack some applications may only allow a list of specific permitted values.We can bypass this filter by giving the original expected machine with the required payload to exploit.
We can also use obfuscation double URl encoding by using Ctrl-U.

Challenge Description:
 This lab has a stock check feature which fetches data from an internal system.
To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.
The developer has deployed an anti-SSRF defense you will need to bypass. 
 	
My Approach:
I vistied checkStock again and change stockApi to http://127.0.0.1/.
The permitted value is 

```
HTTP/2 400 Bad Request
Content-Type: application/json; charset=utf-8
X-Frame-Options: SAMEORIGIN
Content-Length: 58

"External stock check host must be stock.weliketoshop.net"
```
 
Now changing the url to this generally applications support the format http://localhost@stock.weliketoshop.net in which localhost is being real as the url part of it and it gives an error here.
However putting a hash sign is accepted.
Now we can double url encode # and we are good to go.
In which username is being real as the url part of it.

## Redirection
We can redirect the response from teh stockApi domain to the desired domain of the attacker.

Description: This lab has a stock check feature which fetches data from an internal system.
To solve the lab, change the stock check URL to access the admin interface at http://192.168.0.12:8080/admin and delete the user carlos.
The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first. 

My Approach:
I tried with the check Stock bu it didnt work.Exploring around,I found pretty interesting stuff in the Next Product request.I found a path which was an open redirection vulerability.
Now we can feed this Url to the stockApi for it to redirect us to admin and delr=ete carlos username.


